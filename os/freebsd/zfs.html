<!DOCTYPE html>
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        
    <title>zfs</title> 
    
    <link rel="stylesheet" href="../../src/css/fonts.css">
    <link media="screen" rel="stylesheet" href="../../src/css/main.css">
    <link rel="stylesheet" href="../../src/css/monokai-sublime.css">

    <script src="../../src/js/jquery-3.2.1.min.js"></script>
    <script src="../../src/js/highlight.pack.js"></script>
</head>
<body>
    <header class="site-header">
        <ul class="breadcrumbs"></ul>
        <div class="inner">
            <h1 class="site-title"><a class="logo-text" href="https://avis20.github.io/doc/">avis notes</a></h1>
            <p class="site-description">Thoughts, stories and ideas.</p>
        </div><!-- .inner -->


    </header>
    <div class="site-content">
    <div class="inner">
        <main class="site-main">
            <article class="post format-standard hentry">
                <header class="entry-header"> 
                    <div class="entry-header-wrap">
                        <h2 class="entry-title">zfs</h2>
                    </div><!-- .entry-header-wrap -->
                    <div class="entry-meta"> by <span class="post-author author vcard"><span class="fn">Orlov Yaroslav</span></span> on
                        <time class="published" datetime="27-01-2018">27-01-2018</time>
                    </div><!-- .entry-meta -->
                </header><!-- .entry-header -->
                <div class="entry-content">

            <h3 id="zpool">zpool</h3>
            <p>zpool [действие] [ключи]</p>
            <p></p>

            <table><tr><th>Ключ</th><th>Описание</th></tr>
                <tr>
                    <td>-f, --force</td>
                    <td></td>
                </tr>
                <tr>
                    <td>-d</td>
                    <td>Отключить все фичи по умолчанию</td>
                </tr>
                </tr>
                <tr>
                    <td>-o property=value</td>
                    <td>включить <a href="#features">фичу</a></td>
                </tr>
                <tr>
                    <td>-O file-system-property=value</td>
                    <td><a href="#settings_fs">Настройки файловой системы</a></td>
                </tr>
                <tr>
                    <td>-m</td>
                    <td><p>точка монторования<p>Если ее нет, то нужно выбрать legacy или none</p>
                        <ol>
                            <li>none - без монтирования</li>
                            <li>legacy - как я понимаю это наследование уровневых путей. например /export/stuff, то pool/home/user путем наследования получает значение /export/stuff/user
                                <p>Старые точки монтирования. Управление файловыми системами ZFS можно осуществлять при помощи старых средств. Для этого свойство mountpoint должно иметь значение legacy. Управление старыми файловыми системами должно осуществляться с помощью команд mount и umount и файла /etc/vfstab. ZFS не выполняет автоматическое монтирование старых файловых систем при начальной загрузке, и для наборов данных этого типа команды ZFS mount и umount не используются. В следующих примерах демонстрируется настройка и администрирование набора данных ZFS в режиме "legacy":</p></li>
                        </ol>
                    </td>
                </tr>
            </table>

<h3 id="shortcuts">Шпаргалка по командам</h3>

<table>
<tr>
    <td>Справка по командам</td>
    <td>

<pre><code class="shell">man zpool
man zfs
</code></pre>

    </td>
</tr>
<tr>

    <td>Создать пул и посмотреть информацию о нём.
        <p>Интересная особенность в *nix системах - <a href="http://linux.yaroslavl.ru/docs/setup/mandrake/cl/ch09s02.html">Все является файлом</a>. В том числе и диски</p>
    <p>Поэтому, пул дисков можно эмулировать с помощью создания файлов</p>
    <p>Единственное ограничение, диск (или файл) должен быть не менее 64m для самого zfs</p>
    <p>При создании пула, создается фс от корня по названию пула</p>

    </td>
    <td>

<pre><code class="shell"># cd /
# mkfile 100m disk1 disk2 disk3
# ls -l disk*
-rw-------  1 root  wheel  104857600 Jan 27 14:42 disk1
-rw-------  1 root  wheel  104857600 Jan 27 14:42 disk2
-rw-------  1 root  wheel  104857600 Jan 27 14:42 disk3
-rw-------  1 root  wheel   73400320 Jan 20 19:58 disk4
</code></pre>

    </td>

</tr>

<tr>
    <td>
        <p>Создать пулл устройств и посмотреть информацию о нем</p>
    </td>

    <td>
<pre><code class="shell" id="zpool create"># zpool create test01 /disk1 /disk2
# zpool list
NAME     SIZE  ALLOC   FREE  EXPANDSZ   FRAG    CAP  DEDUP  HEALTH  ALTROOT
test01   160M    62K   160M         -     1%     0%  1.00x  ONLINE  -
</code></pre>

    </td>

</tr>

<tr>
    <td>Подробная информация о пуле</td>
    <td>
        <pre><code class="shell"># zpool status -v
  pool: test01
 state: ONLINE
  scan: none requested
config:

    NAME        STATE     READ WRITE CKSUM
    test01      ONLINE       0     0     0
      /disk1    ONLINE       0     0     0
      /disk2    ONLINE       0     0     0

errors: No known data errors</code></pre>
    </td>
</tr>

tr>td+td>pre>code.shell

</table>

<h3 id="reference">Reference</h3>

<ul>
<li><a href="https://docs.oracle.com/cd/E19253-01/820-0836/zfsover-2/index.html">Что такое ZFS</a></li>
<li><a href="https://docs.oracle.com/cd/E19253-01/820-0836/gaztn/index.html">Точки монторивания</a></li>
<li><a href="https://www.youtube.com/watch?v=ZhlkwTNkh58&list=PLFHbPE9PGy7UNZb0IkpJc8KB_drOIL64M&t=1221s&index=10">ZFS на Linux Debian 8. Часть 1</a></li>
<li><a href="https://www.youtube.com/watch?v=j06efTacH3E&t=36s">Установка FreeBSD+ZFS</a></li>
<li><a href="https://confluence.prototypes.ru/x/C4-/">confluence</a></li>
<li><a href="https://deathstar.name/ustanovka-freebsd-na-zfs-vklyuchaya-kornevoj-razdel/">Установка FreeBSD на ZFS включая корневой раздел</a></li>
<li><a href="1 http://www.lissyara.su/articles/freebsd/file_system/root_zfs_gpt/">Установка FreeBSD на ZFS/root или Пособие себе на память</a></li>
<li><a href="http://dreamcatcher.ru/2010/01/10/%D0%A8%D0%BF%D0%B0%D1%80%D0%B3%D0%B0%D0%BB%D0%BA%D0%B0-%D0%BF%D0%BE-zfs/">Шпаргалка-по-zfs</a></li>
<li><a href="http://xgu.ru/wiki/ZFS">Пример использования ZFS</a></li>
</ul>

        </main>

    <aside class="sidebar">

        <section class="widget widget-recent-posts">

            <h2 class="widget-title">Toc</h2>
            <div class="toc"></div>

            <h2 class="widget-title">Notes</h2>
            
<iframe src="../../tree.html" frameborder="0" height="500px" target="_parent"></iframe>

        </section><!-- .widget-recent-posts -->

    </aside>

    <script src="../../src/js/main.js"></script>
</body>
</html>